{
  "messages": [
    {
      "role": "system",
      "content": "You are an AI assistant tasked with refining D&D 5e game state data to fit a specific JSON schema. Return only the corrected JSON object with no additional text."
    },
    {
      "role": "user",
      "content": "Refine the following game state data to conform to the provided JSON schema. Schema:\n{\n  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\n  \"title\": \"D&D 5e Game State Schema\",\n  \"description\": \"A schema defining the structure for D&D 5e game state data, including players, NPCs, inventory, spells, and conditions.\",\n  \"type\": \"object\",\n  \"properties\": {\n    \"players\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"required\": [\n          \"name\",\n          \"hp\",\n          \"ac\",\n          \"strength\",\n          \"dexterity\",\n          \"constitution\",\n          \"intelligence\",\n          \"wisdom\",\n          \"charisma\",\n          \"class_type\"\n        ],\n        \"properties\": {\n          \"name\": {\n            \"type\": \"string\"\n          },\n          \"hp\": {\n            \"type\": \"integer\"\n          },\n          \"ac\": {\n            \"type\": \"integer\"\n          },\n          \"strength\": {\n            \"type\": \"integer\"\n          },\n          \"dexterity\": {\n            \"type\": \"integer\"\n          },\n          \"constitution\": {\n            \"type\": \"integer\"\n          },\n          \"intelligence\": {\n            \"type\": \"integer\"\n          },\n          \"wisdom\": {\n            \"type\": \"integer\"\n          },\n          \"charisma\": {\n            \"type\": \"integer\"\n          },\n          \"class_type\": {\n            \"type\": \"string\",\n            \"enum\": [\n              \"wizard\",\n              \"sorcerer\",\n              \"fighter\",\n              \"rogue\",\n              \"cleric\",\n              \"barbarian\",\n              \"paladin\",\n              \"ranger\",\n              \"druid\",\n              \"monk\",\n              \"warlock\",\n              \"bard\"\n            ]\n          },\n          \"damage\": {\n            \"type\": \"string\",\n            \"pattern\": \"^\\\\d+d\\\\d+(\\\\s*\\\\+\\\\s*\\\\d+)?$\"\n          },\n          \"inventory\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"type\": \"object\",\n              \"required\": [\n                \"name\",\n                \"type\"\n              ],\n              \"properties\": {\n                \"name\": {\n                  \"type\": \"string\"\n                },\n                \"type\": {\n                  \"type\": \"string\",\n                  \"enum\": [\n                    \"melee\",\n                    \"ranged\",\n                    \"magic\",\n                    \"armor\",\n                    \"potion\",\n                    \"scroll\",\n                    \"misc\"\n                  ]\n                },\n                \"damage\": {\n                  \"type\": \"string\",\n                  \"pattern\": \"^\\\\d+d\\\\d+(\\\\s*\\\\+\\\\s*\\\\d+)?$\"\n                },\n                \"finesse\": {\n                  \"type\": \"boolean\"\n                },\n                \"versatile\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"one_hand\": {\n                      \"type\": \"string\",\n                      \"pattern\": \"^\\\\d+d\\\\d+(\\\\s*\\\\+\\\\s*\\\\d+)?$\"\n                    },\n                    \"two_hands\": {\n                      \"type\": \"string\",\n                      \"pattern\": \"^\\\\d+d\\\\d+(\\\\s*\\\\+\\\\s*\\\\d+)?$\"\n                    }\n                  },\n                  \"required\": [\n                    \"one_hand\",\n                    \"two_hands\"\n                  ]\n                },\n                \"mod\": {\n                  \"type\": \"string\",\n                  \"enum\": [\n                    \"strength\",\n                    \"dexterity\",\n                    \"intelligence\",\n                    \"wisdom\",\n                    \"charisma\",\n                    \"constitution\"\n                  ]\n                }\n              }\n            }\n          },\n          \"spells\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"type\": \"object\",\n              \"required\": [\n                \"name\",\n                \"type\",\n                \"targeting\"\n              ],\n              \"properties\": {\n                \"name\": {\n                  \"type\": \"string\"\n                },\n                \"type\": {\n                  \"type\": \"string\",\n                  \"enum\": [\n                    \"damage\",\n                    \"healing\",\n                    \"buff\",\n                    \"debuff\",\n                    \"utility\"\n                  ]\n                },\n                \"damage\": {\n                  \"type\": \"string\",\n                  \"pattern\": \"^\\\\d+d\\\\d+(\\\\s*\\\\+\\\\s*\\\\d+)?$\"\n                },\n                \"healing\": {\n                  \"type\": \"string\",\n                  \"pattern\": \"^\\\\d+d\\\\d+(\\\\s*\\\\+\\\\s*\\\\d+)?$\"\n                },\n                \"effect\": {\n                  \"type\": \"object\",\n                  \"required\": [\n                    \"attribute\",\n                    \"modifier\",\n                    \"duration\"\n                  ],\n                  \"properties\": {\n                    \"attribute\": {\n                      \"type\": \"string\",\n                      \"enum\": [\n                        \"ac\",\n                        \"health\",\n                        \"visibility\",\n                        \"speed\",\n                        \"strength\",\n                        \"dexterity\",\n                        \"constitution\",\n                        \"intelligence\",\n                        \"wisdom\",\n                        \"charisma\",\n                        \"advantage\",\n                        \"disadvantage\"\n                      ]\n                    },\n                    \"modifier\": {\n                      \"type\": [\n                        \"integer\",\n                        \"string\"\n                      ]\n                    },\n                    \"duration\": {\n                      \"type\": \"integer\",\n                      \"minimum\": 0\n                    }\n                  }\n                },\n                \"save\": {\n                  \"type\": \"string\",\n                  \"enum\": [\n                    \"strength\",\n                    \"dexterity\",\n                    \"constitution\",\n                    \"intelligence\",\n                    \"wisdom\",\n                    \"charisma\",\n                    \"\"\n                  ]\n                },\n                \"dc\": {\n                  \"type\": \"integer\",\n                  \"minimum\": 0\n                },\n                \"targeting\": {\n                  \"type\": \"string\",\n                  \"enum\": [\n                    \"single\",\n                    \"aoe\",\n                    \"self\"\n                  ]\n                }\n              }\n            }\n          },\n          \"conditions\": {\n            \"type\": \"object\",\n            \"additionalProperties\": {\n              \"type\": \"integer\",\n              \"minimum\": 0\n            }\n          }\n        }\n      }\n    },\n    \"npcs\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"required\": [\n          \"name\",\n          \"hp\",\n          \"ac\",\n          \"strength\",\n          \"dexterity\",\n          \"constitution\",\n          \"intelligence\",\n          \"wisdom\",\n          \"charisma\",\n          \"class_type\"\n        ],\n        \"properties\": {\n          \"name\": {\n            \"type\": \"string\"\n          },\n          \"hp\": {\n            \"type\": \"integer\"\n          },\n          \"ac\": {\n            \"type\": \"integer\"\n          },\n          \"strength\": {\n            \"type\": \"integer\"\n          },\n          \"dexterity\": {\n            \"type\": \"integer\"\n          },\n          \"constitution\": {\n            \"type\": \"integer\"\n          },\n          \"intelligence\": {\n            \"type\": \"integer\"\n          },\n          \"wisdom\": {\n            \"type\": \"integer\"\n          },\n          \"charisma\": {\n            \"type\": \"integer\"\n          },\n          \"class_type\": {\n            \"type\": \"string\",\n            \"enum\": [\n              \"wizard\",\n              \"fighter\",\n              \"sorcerer\",\n              \"rogue\",\n              \"cleric\",\n              \"barbarian\",\n              \"paladin\",\n              \"ranger\",\n              \"druid\",\n              \"monk\",\n              \"warlock\",\n              \"bard\",\n              \"monster\",\n              \"beast\"\n            ]\n          },\n          \"damage\": {\n            \"type\": \"string\",\n            \"pattern\": \"^\\\\d+d\\\\d+(\\\\s*\\\\+\\\\s*\\\\d+)?$\"\n          },\n          \"inventory\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"type\": \"object\",\n              \"required\": [\n                \"name\",\n                \"type\"\n              ],\n              \"properties\": {\n                \"name\": {\n                  \"type\": \"string\"\n                },\n                \"type\": {\n                  \"type\": \"string\",\n                  \"enum\": [\n                    \"melee\",\n                    \"ranged\",\n                    \"magic\",\n                    \"armor\",\n                    \"potion\",\n                    \"scroll\",\n                    \"misc\"\n                  ]\n                },\n                \"damage\": {\n                  \"type\": \"string\",\n                  \"pattern\": \"^\\\\d+d\\\\d+(\\\\s*\\\\+\\\\s*\\\\d+)?$\"\n                },\n                \"finesse\": {\n                  \"type\": \"boolean\"\n                },\n                \"mod\": {\n                  \"type\": \"string\",\n                  \"enum\": [\n                    \"strength\",\n                    \"dexterity\",\n                    \"intelligence\",\n                    \"wisdom\",\n                    \"charisma\",\n                    \"constitution\"\n                  ]\n                }\n              }\n            }\n          },\n          \"spells\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"type\": \"object\",\n              \"required\": [\n                \"name\",\n                \"type\",\n                \"targeting\"\n              ],\n              \"properties\": {\n                \"name\": {\n                  \"type\": \"string\"\n                },\n                \"type\": {\n                  \"type\": \"string\",\n                  \"enum\": [\n                    \"damage\",\n                    \"healing\",\n                    \"buff\",\n                    \"debuff\",\n                    \"utility\"\n                  ]\n                },\n                \"damage\": {\n                  \"type\": \"string\",\n                  \"pattern\": \"^\\\\d+d\\\\d+(\\\\s*\\\\+\\\\s*\\\\d+)?$\"\n                },\n                \"healing\": {\n                  \"type\": \"string\",\n                  \"pattern\": \"^\\\\d+d\\\\d+(\\\\s*\\\\+\\\\s*\\\\d+)?$\"\n                },\n                \"effect\": {\n                  \"type\": \"object\",\n                  \"required\": [\n                    \"attribute\",\n                    \"modifier\",\n                    \"duration\"\n                  ],\n                  \"properties\": {\n                    \"attribute\": {\n                      \"type\": \"string\",\n                      \"enum\": [\n                        \"ac\",\n                        \"health\",\n                        \"visibility\",\n                        \"speed\",\n                        \"strength\",\n                        \"dexterity\",\n                        \"constitution\",\n                        \"intelligence\",\n                        \"wisdom\",\n                        \"charisma\",\n                        \"advantage\",\n                        \"disadvantage\"\n                      ]\n                    },\n                    \"modifier\": {\n                      \"type\": [\n                        \"integer\",\n                        \"string\"\n                      ]\n                    },\n                    \"duration\": {\n                      \"type\": \"integer\",\n                      \"minimum\": 0\n                    }\n                  }\n                },\n                \"save\": {\n                  \"type\": \"string\",\n                  \"enum\": [\n                    \"strength\",\n                    \"dexterity\",\n                    \"constitution\",\n                    \"intelligence\",\n                    \"wisdom\",\n                    \"charisma\",\n                    \"\"\n                  ]\n                },\n                \"dc\": {\n                  \"type\": \"integer\",\n                  \"minimum\": 0\n                },\n                \"targeting\": {\n                  \"type\": \"string\",\n                  \"enum\": [\n                    \"single\",\n                    \"aoe\",\n                    \"self\"\n                  ]\n                }\n              }\n            }\n          },\n          \"conditions\": {\n            \"type\": \"object\",\n            \"additionalProperties\": {\n              \"type\": \"integer\",\n              \"minimum\": 0\n            }\n          }\n        }\n      }\n    }\n  },\n  \"required\": [\n    \"players\",\n    \"npcs\"\n  ]\n}\n\nNon-conforming data:\n{\n  \"players\": [\n    {\n      \"name\": \"Emolas\",\n      \"hp\": 45,\n      \"ac\": 15,\n      \"strength\": 12,\n      \"dexterity\": 16,\n      \"constitution\": 13,\n      \"intelligence\": 14,\n      \"wisdom\": 10,\n      \"charisma\": 15,\n      \"class_type\": \"rogue\",\n      \"damage\": \"1d6\",\n      \"inventory\": [\n        {\n          \"name\": \"Khan's Shortbow\",\n          \"type\": \"ranged\",\n          \"damage\": \"3d6\",\n          \"finesse\": false,\n          \"versatile\": false,\n          \"mod\": \"dexterity\"\n        },\n        {\n          \"name\": \"Dagger\",\n          \"type\": \"melee\",\n          \"damage\": \"1d4\",\n          \"finesse\": true,\n          \"mod\": \"dexterity\"\n        },\n        {\n          \"name\": \"Moonlight Katana\",\n          \"type\": \"melee\",\n          \"damage\": \"1d8+3\",\n          \"finesse\": true,\n          \"mod\": \"dexterity\"\n        }\n      ],\n      \"spells\": [\n        {\n          \"name\": \"Sonic Disintegration\",\n          \"type\": \"damage\",\n          \"damage\": \"2d10+2\",\n          \"healing\": \"\",\n          \"effect\": {\n            \"attribute\": \"rock-like structures\",\n            \"modifier\": \"melted\",\n            \"duration\": \"instantaneous\"\n          },\n          \"targeting\": \"single\"\n        },\n        {\n          \"name\": \"Fortune's Favor\",\n          \"type\": \"buff\",\n          \"effect\": {\n            \"attribute\": \"adv_disadv\",\n            \"modifier\": \"advantage\",\n            \"duration\": 4\n          },\n          \"targeting\": \"single\"\n        },\n        {\n          \"name\": \"Curse of Misfortune\",\n          \"type\": \"debuff\",\n          \"effect\": {\n            \"attribute\": \"adv_disadv\",\n            \"modifier\": \"disadvantage\",\n            \"duration\": 3\n          },\n          \"targeting\": \"single\"\n        },\n        {\n          \"name\": \"Dancing Lights\",\n          \"type\": \"utility\",\n          \"effect\": {\n            \"attribute\": \"light\",\n            \"modifier\": \"bright\",\n            \"duration\": 10\n          },\n          \"save\": null,\n          \"dc\": null,\n          \"targeting\": \"self\"\n        },\n        {\n          \"name\": \"Faerie Fire\",\n          \"type\": \"utility\",\n          \"effect\": {\n            \"attribute\": \"visibility\",\n            \"modifier\": \"advantage on attacks\",\n            \"duration\": 10\n          },\n          \"save\": \"dexterity\",\n          \"dc\": 14,\n          \"targeting\": \"aoe\"\n        },\n        {\n          \"name\": \"Minor Illusion\",\n          \"type\": \"utility\",\n          \"effect\": {\n            \"attribute\": \"visibility\",\n            \"modifier\": \"disadvantage\",\n            \"duration\": 2\n          },\n          \"targeting\": \"self\"\n        },\n        {\n          \"name\": \"Stealthy Concealment\",\n          \"type\": \"buff\",\n          \"effect\": {\n            \"attribute\": \"ac\",\n            \"modifier\": \"disadvantage\",\n            \"duration\": 2\n          },\n          \"targeting\": \"self\"\n        },\n        {\n          \"name\": \"Sneak Attack\",\n          \"type\": \"damage\",\n          \"damage\": \"2d6\",\n          \"effect\": {\n            \"attribute\": \"health\",\n            \"modifier\": -2,\n            \"duration\": 1\n          },\n          \"save\": \"dexterity\",\n          \"dc\": 15,\n          \"targeting\": \"single\"\n        },\n        {\n          \"name\": \"Expertise\",\n          \"type\": \"buff\",\n          \"effect\": {\n            \"attribute\": \"skill\",\n            \"modifier\": 3,\n            \"duration\": 1\n          },\n          \"save\": null,\n          \"dc\": null,\n          \"targeting\": \"self\"\n        },\n        {\n          \"name\": \"Cunning Action\",\n          \"type\": \"utility\",\n          \"effect\": {\n            \"attribute\": \"movement\",\n            \"modifier\": \"bonus action\",\n            \"duration\": 1\n          },\n          \"save\": null,\n          \"dc\": null,\n          \"targeting\": \"self\"\n        }\n      ],\n      \"conditions\": {}\n    }\n  ],\n  \"npcs\": [\n    {\n      \"name\": \"Threx the Brutal\",\n      \"hp\": 60,\n      \"ac\": 14,\n      \"strength\": 18,\n      \"dexterity\": 12,\n      \"constitution\": 16,\n      \"intelligence\": 8,\n      \"wisdom\": 10,\n      \"charisma\": 9,\n      \"class_type\": \"barbarian\",\n      \"damage\": \"2d6\",\n      \"inventory\": [\n        {\n          \"name\": \"Greataxe\",\n          \"type\": \"melee\",\n          \"damage\": \"1d12\",\n          \"finesse\": false,\n          \"versatile\": {\n            \"one_hand\": null,\n            \"two_hands\": \"1d12\"\n          },\n          \"mod\": \"strength\"\n        },\n        {\n          \"name\": \"Handaxe\",\n          \"type\": \"melee\",\n          \"damage\": \"1d6\",\n          \"finesse\": false,\n          \"versatile\": {\n            \"one_hand\": \"1d6\",\n            \"two_hands\": null\n          },\n          \"mod\": \"strength\"\n        }\n      ],\n      \"spells\": [],\n      \"conditions\": {}\n    },\n    {\n      \"name\": \"Selara the Dark\",\n      \"hp\": 40,\n      \"ac\": 13,\n      \"strength\": 10,\n      \"dexterity\": 14,\n      \"constitution\": 12,\n      \"intelligence\": 14,\n      \"wisdom\": 12,\n      \"charisma\": 16,\n      \"class_type\": \"warlock\",\n      \"damage\": \"1d10\",\n      \"inventory\": [\n        {\n          \"name\": \"Eldritch Blast\",\n          \"type\": \"magic\",\n          \"damage\": \"1d10\",\n          \"finesse\": false,\n          \"versatile\": {\n            \"one_hand\": null,\n            \"two_hands\": null\n          },\n          \"mod\": \"charisma\"\n        },\n        {\n          \"name\": \"Dagger\",\n          \"type\": \"melee\",\n          \"damage\": \"1d4\",\n          \"finesse\": true,\n          \"versatile\": {\n            \"one_hand\": \"1d4\",\n            \"two_hands\": null\n          },\n          \"mod\": \"dexterity\"\n        }\n      ],\n      \"spells\": [\n        {\n          \"name\": \"Hex\",\n          \"type\": \"condition\",\n          \"effect\": {\n            \"attribute\": \"disadvantage\",\n            \"modifier\": 0,\n            \"duration\": 1\n          },\n          \"save\": null,\n          \"dc\": null,\n          \"targeting\": \"single\"\n        },\n        {\n          \"name\": \"Hellish Rebuke\",\n          \"type\": \"damage\",\n          \"damage\": \"2d10\",\n          \"effect\": {\n            \"attribute\": \"fire\",\n            \"modifier\": 0,\n            \"duration\": null\n          },\n          \"save\": \"dexterity\",\n          \"dc\": 14,\n          \"targeting\": \"single\"\n        }\n      ],\n      \"conditions\": {}\n    },\n    {\n      \"name\": \"Orc\",\n      \"hp\": 15,\n      \"ac\": 13,\n      \"strength\": 14,\n      \"dexterity\": 12,\n      \"constitution\": 13,\n      \"intelligence\": 8,\n      \"wisdom\": 10,\n      \"charisma\": 6,\n      \"class_type\": \"fighter\",\n      \"damage\": \"1d6\",\n      \"inventory\": [\n        {\n          \"name\": \"Greataxe\",\n          \"type\": \"melee\",\n          \"damage\": \"1d12\",\n          \"finesse\": false,\n          \"mod\": \"strength\"\n        }\n      ],\n      \"conditions\": {}\n    },\n    {\n      \"name\": \"Goblin\",\n      \"hp\": 12,\n      \"ac\": 15,\n      \"strength\": 10,\n      \"dexterity\": 14,\n      \"constitution\": 10,\n      \"intelligence\": 8,\n      \"wisdom\": 8,\n      \"charisma\": 8,\n      \"class_type\": \"fighter\",\n      \"damage\": \"1d6\",\n      \"inventory\": [\n        {\n          \"name\": \"Scimitar\",\n          \"type\": \"melee\",\n          \"damage\": \"1d6\",\n          \"finesse\": true,\n          \"mod\": \"dexterity\"\n        },\n        {\n          \"name\": \"Shortbow\",\n          \"type\": \"ranged\",\n          \"damage\": \"1d6\",\n          \"finesse\": false,\n          \"mod\": \"dexterity\"\n        }\n      ],\n      \"conditions\": {}\n    },\n    {\n      \"name\": \"Troll\",\n      \"hp\": 30,\n      \"ac\": 13,\n      \"strength\": 18,\n      \"dexterity\": 10,\n      \"constitution\": 16,\n      \"intelligence\": 7,\n      \"wisdom\": 9,\n      \"charisma\": 6,\n      \"class_type\": \"barbarian\",\n      \"damage\": \"1d10\",\n      \"inventory\": [\n        {\n          \"name\": \"Club\",\n          \"type\": \"melee\",\n          \"damage\": \"1d10\",\n          \"finesse\": false,\n          \"mod\": \"strength\"\n        }\n      ],\n      \"conditions\": {}\n    },\n    {\n      \"name\": \"Goblin Witch\",\n      \"hp\": 18,\n      \"ac\": 12,\n      \"strength\": 8,\n      \"dexterity\": 14,\n      \"constitution\": 10,\n      \"intelligence\": 14,\n      \"wisdom\": 12,\n      \"charisma\": 10,\n      \"class_type\": \"sorcerer\",\n      \"damage\": \"1d4\",\n      \"inventory\": [\n        {\n          \"name\": \"Magic Staff\",\n          \"type\": \"magic\",\n          \"damage\": \"1d4\",\n          \"finesse\": false,\n          \"mod\": \"intelligence\"\n        }\n      ],\n      \"spells\": [\n        {\n          \"name\": \"Magic Missile\",\n          \"type\": \"damage\",\n          \"damage\": \"3d4+3\",\n          \"save\": null,\n          \"dc\": null,\n          \"targeting\": \"single\"\n        },\n        {\n          \"name\": \"Burning Hands\",\n          \"type\": \"damage\",\n          \"damage\": \"3d6\",\n          \"save\": \"dexterity\",\n          \"dc\": 13,\n          \"targeting\": \"aoe\"\n        },\n        {\n          \"name\": \"Cure Wounds\",\n          \"type\": \"healing\",\n          \"healing\": \"1d8+3\",\n          \"save\": null,\n          \"dc\": null,\n          \"targeting\": \"self\"\n        }\n      ],\n      \"conditions\": {}\n    }\n  ]\n}\n\nFill in missing fields with appropriate D&D 5e values, remove invalid fields, and adjust existing fields to match the schema. Ensure the following: - For 'save' fields in spells, use a string value from ['strength', 'dexterity', 'constitution', 'intelligence', 'wisdom', 'charisma', ''] and avoid 'None' or null values. Use '' (empty string) if no saving throw is required. - For 'attribute' fields in spell effects, only use values from ['ac', 'health', 'visibility', 'speed', 'strength', 'dexterity', 'constitution', 'intelligence', 'wisdom', 'charisma', 'advantage', 'disadvantage']. Replace invalid values like 'movement' with 'speed'. Return ONLY the corrected JSON object with no additional text or formatting."
    }
  ],
  "model": "llama-3.3-70b",
  "temperature": 0.5,
  "venice_parameters": {
    "enable_web_search": "auto"
  },
  "parallel_tool_calls": true
}